---
import { getLocaleInfo, translateFor } from "@/i18n/utils";
import { DEFAULT_LOCALE } from "@/i18n/config";
import Hr from "./Hr.astro";
import Socials from "./Socials.astro";

export interface Props {
  noMarginTop?: boolean;
}

const lang = Astro.currentLocale ?? DEFAULT_LOCALE;
const t = translateFor(lang);
const LOCALE = getLocaleInfo(lang);

const currentYear = new Date().toLocaleDateString(LOCALE.langTag, {
  year: "numeric",
});

const { noMarginTop = false } = Astro.props;

// Lógica dos Links das Políticas
const langPrefix = lang === DEFAULT_LOCALE ? "" : `/${lang}`;
const privacyLink = `${langPrefix}/policies/${t("footer.privacySlug")}`;
const termsLink = `${langPrefix}/policies/${t("footer.termsSlug")}`;
---

<footer class:list={["w-full", { "mt-auto": !noMarginTop }]}>
  <Hr noPadding />

  <div class="px-4 pt-6 pb-2">
    <div
      class="mx-auto mb-6 flex max-w-4xl flex-col items-center gap-4 text-center"
    >
      <p class="text-skin-base text-sm font-medium opacity-90">
        {t("footer.greenSoftware")}
      </p>

      <p class="text-skin-base max-w-2xl text-xs leading-relaxed opacity-80">
        {t("footer.ipDisclaimer")}
      </p>
    </div>

    <div class="border-skin-line mx-auto mb-6 w-1/2 border-t opacity-50"></div>

    <div
      class="flex flex-col items-center justify-between sm:flex-row-reverse sm:py-4"
    >
      <Socials centered />

      <div
        class="flex flex-col items-center text-center sm:items-start sm:text-left"
      >
        <div class="my-2 flex flex-col items-center sm:flex-row">
          <span>{t("footer.text", { year: currentYear })}</span>
        </div>

        <div
          class="text-skin-base mt-1 flex flex-wrap justify-center gap-3 text-xs opacity-70 sm:justify-start"
        >
          <a
            href={privacyLink}
            class="hover:text-skin-accent decoration-dashed underline-offset-4 transition-colors hover:underline"
          >
            {t("footer.privacy")}
          </a>
          <span>|</span>
          <a
            href={termsLink}
            class="hover:text-skin-accent decoration-dashed underline-offset-4 transition-colors hover:underline"
          >
            {t("footer.terms")}
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>
